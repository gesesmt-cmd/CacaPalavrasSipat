<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>17.08</title>
    <!-- O CSS (style) permanece o mesmo, foi omitido aqui para economizar espa√ßo -->
    <style> body { font-family: 'Arial', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); margin: 0; padding: 20px; min-height: 100vh; display: flex; flex-direction: column; align-items: center; } .container { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); max-width: 500px; width: 100%; text-align: center; } .game-container { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); max-width: 1400px; width: 100%; } h1 { text-align: center; color: #2c3e50; margin-bottom: 10px; font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); } .subtitle { text-align: center; color: #7f8c8d; margin-bottom: 30px; font-size: 1.2em; } .login-form { margin-bottom: 30px; } .form-group { margin-bottom: 20px; text-align: left; } .form-group label { display: block; margin-bottom: 5px; color: #2c3e50; font-weight: bold; } .form-group input { width: 100%; padding: 12px; border: 2px solid #bdc3c7; border-radius: 8px; font-size: 16px; transition: border-color 0.3s ease; } .form-group input:focus { outline: none; border-color: #3498db; } .error-message { color: #e74c3c; font-size: 14px; margin-top: 5px; display: none; } .game-content { display: flex; gap: 30px; flex-wrap: wrap; justify-content: center; } .crossword-grid { background: #f8f9fa; border: 3px solid #34495e; border-radius: 10px; padding: 20px; display: inline-block; } .grid { display: grid; grid-template-columns: repeat(21, 30px); grid-template-rows: repeat(21, 30px); gap: 1px; } .cell { width: 30px; height: 30px; border: 1px solid #bdc3c7; display: flex; align-items: center; justify-content: center; background: white; font-weight: bold; font-size: 12px; position: relative; transition: all 0.3s ease; } .cell.blocked { background: #34495e; border: 1px solid #2c3e50; color: white; } .cell input { width: 100%; height: 100%; border: none; text-align: center; font-weight: bold; font-size: 12px; text-transform: uppercase; background: transparent; outline: none; } .cell input:focus { background: #3498db; color: white; } .cell.correct { background: #2ecc71; animation: pulse 0.5s ease-in-out; } .cell.incorrect { background: #e74c3c; animation: shake 0.5s ease-in-out; } .number { position: absolute; top: 1px; left: 1px; font-size: 8px; color: #f1c40f; font-weight: bold; } .clues-section { background: #ecf0f1; border-radius: 10px; padding: 20px; min-width: 300px; max-width: 400px; } .clues h3 { color: #2c3e50; margin-bottom: 15px; border-bottom: 2px solid #3498db; padding-bottom: 5px; } .clue { margin-bottom: 10px; padding: 10px; background: white; border-radius: 5px; border-left: 4px solid #3498db; cursor: pointer; transition: all 0.3s ease; font-size: 14px; } .clue:hover { background: #f1c40f; transform: translateX(5px); } .clue.completed { background: #2ecc71; color: white; border-left-color: #27ae60; } .controls { text-align: center; margin: 20px 0; } .btn { background: linear-gradient(45deg, #3498db, #2980b9); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-size: 16px; margin: 0 10px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3); } .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4); } .btn:disabled { background: #bdc3c7; cursor: not-allowed; transform: none; box-shadow: none; } .progress { margin: 20px 0; text-align: center; } .progress-bar { width: 100%; height: 20px; background: #ecf0f1; border-radius: 10px; overflow: hidden; margin: 10px 0; } .progress-fill { height: 100%; background: linear-gradient(45deg, #2ecc71, #27ae60); width: 0%; transition: width 0.5s ease; } .player-info { background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; border: 2px solid #3498db; } .player-info h3 { color: #2c3e50; margin: 0 0 10px 0; } .player-info p { margin: 5px 0; color: #7f8c8d; } @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } } @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } } .success-message { background: #2ecc71; color: white; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: center; font-size: 18px; display: none; animation: fadeInUp 0.5s ease-in-out; } @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } } .hidden { display: none !important; } @media (max-width: 768px) { .game-content { flex-direction: column; align-items: center; } .grid { grid-template-columns: repeat(21, 22px); grid-template-rows: repeat(21, 22px); } .cell { width: 22px; height: 22px; font-size: 10px; } } .game-over-message { background: #e74c3c; color: white; padding: 20px 30px; border-radius: 10px; margin: 20px 0; text-align: center; font-size: 18px; animation: fadeInUp 0.5s ease-in-out; } .game-over-message h2 { margin-top: 0; font-size: 2em; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); } </style>
</head>
<body>

    <!-- LOGIN -->
    <div id="login-screen" class="container">
        <h1>üõ°Ô∏è Cruzadinha de Seguran√ßa do Trabalho</h1>
        <p class="subtitle">Complete seus dados para come√ßar o jogo</p>

        <form id="login-form" class="login-form">
            <div class="form-group">
                <label for="player-name">Nome Completo:</label>
                <input type="text" id="player-name" placeholder="Digite seu nome completo" required>
                <div class="error-message" id="name-error">Por favor, digite seu nome completo.</div>
            </div>

            <div class="form-group">
                <label for="player-cpf">CPF:</label>
                <input type="text" id="player-cpf" placeholder="000.000.000-00" maxlength="14" required>
                <div class="error-message" id="cpf-error">Por favor, digite um CPF v√°lido.</div>
            </div>

            <button type="submit" class="btn">üéÆ Come√ßar a Jogar</button>
        </form>
    </div>

    <!-- GAME -->
    <div id="game-screen" class="game-container hidden">
        <h1 id="game-title">üõ°Ô∏è Cruzadinha de Seguran√ßa do Trabalho</h1>

        <div class="player-info">
            <h3>üèÜ Jogador</h3>
            <p><strong>Nome:</strong> <span id="display-name"></span></p>
            <p><strong>CPF:</strong> <span id="display-cpf"></span></p>
            <p><strong>Pontua√ß√£o:</strong> <span id="score-display">100</span></p>
            <p><strong>Dicas Restantes:</strong> <span id="hints-display">5</span></p>
            <p><strong>Tempo:</strong> <span id="timer-display">00:00</span></p>
        </div>

        <div class="progress">
            <p>Progresso: <span id="progress-text">0/10 palavras</span></p>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" onclick="checkAnswers()">‚úì Verificar Respostas</button>
            <button class="btn" onclick="clearGrid()">üîÑ Limpar N√≠vel</button>
            <button class="btn" onclick="showHint()">üí° Dica (-20 pts)</button>
            <button class="btn" onclick="showLogin()">üë§ Novo Jogador</button>
            <button class="btn" onclick="autoFillWords()">‚ö° Preencher Tudo (teste)</button>

        </div>

        <div class="success-message" id="success-message">
            üéâ Parab√©ns! Voc√™ completou TODOS os desafios! Sua pontua√ß√£o foi enviada. üéâ
        </div>

        <div class="game-over-message hidden" id="game-over-message">
            <h2>GAME OVER</h2>
            <p>Sua pontua√ß√£o chegou a zero. Voc√™ n√£o pode mais continuar.</p>
            <button class="btn" onclick="restartCurrentGame()">Tentar Novamente</button>
        </div>

        <div class="game-content">
            <div class="crossword-grid">
                <div class="grid" id="crossword-grid"></div>
            </div>

            <div class="clues-section">
                <div id="vertical-clues" class="clues">
                    <h3>üîΩ Verticais</h3>
                </div>

                <div id="horizontal-clues" class="clues">
                    <h3>‚û°Ô∏è Horizontais</h3>
                </div>
            </div>
        </div>
    </div>
    <script>
        // --- URL DO SEU APP SCRIPT ---
        const SCRIPT_URL = "COLE_AQUI_SUA_URL_DO_APPS_SCRIPT";
        
        // Configura√ß√µes do jogo
        const INITIAL_SCORE = 100;
        const HINT_COST = 20;
        const MAX_HINTS = 5;
        
        let words = {};
        let currentLevel = 0;
        let timerInterval = null;
        let secondsElapsed = 0;
        let score = INITIAL_SCORE;
        let hintsRemaining = MAX_HINTS;
        let completedWords = new Set();
        let currentPlayer = { name: '', cpf: '' };
        
        // --- UTILIT√ÅRIOS ---
        function normalize(str) {
            if (!str) return '';
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase();
        }
        
        function formatCPF(cpf) {
            cpf = cpf.replace(/\D/g, '');
            cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2');
            cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2');
            cpf = cpf.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            return cpf;
        }
        
        function validateCPF(cpf) {
            cpf = cpf.replace(/\D/g, '');
            if (cpf.length !== 11 || /^(\d)\1{10}$/.test(cpf)) return false;
            let sum = 0, remainder;
            for (let i = 1; i <= 9; i++) sum += parseInt(cpf.substring(i - 1, i)) * (11 - i);
            remainder = (sum * 10) % 11;
            if ((remainder === 10) || (remainder === 11)) remainder = 0;
            if (remainder !== parseInt(cpf.substring(9, 10))) return false;
            sum = 0;
            for (let i = 1; i <= 10; i++) sum += parseInt(cpf.substring(i - 1, i)) * (12 - i);
            remainder = (sum * 10) % 11;
            if ((remainder === 10) || (remainder === 11)) remainder = 0;
            if (remainder !== parseInt(cpf.substring(10, 11))) return false;
            return true;
        }
        
        // --- LOGIN ---
        document.getElementById('player-cpf').addEventListener('input', (e) => e.target.value = formatCPF(e.target.value));
        
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('player-name').value.trim();
            const cpf = document.getElementById('player-cpf').value;
            let valid = true;
        
            document.getElementById('name-error').style.display = name.length < 3 ? 'block' : 'none';
            if (name.length < 3) valid = false;
        
            document.getElementById('cpf-error').style.display = !validateCPF(cpf) ? 'block' : 'none';
            if (!validateCPF(cpf)) valid = false;
        
            if (valid) {
                currentPlayer = { name, cpf };
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('game-screen').classList.remove('hidden');
                startGame();
            }
        });
        
        // --- IN√çCIO DO JOGO ---
        function startGame() {
            document.getElementById('display-name').textContent = currentPlayer.name;
            document.getElementById('display-cpf').textContent = currentPlayer.cpf;
            score = INITIAL_SCORE;
            secondsElapsed = 0;
            hintsRemaining = MAX_HINTS;
            currentLevel = 0;
            updateScoreDisplay();
            updateHintsDisplay();
            loadLevel(currentLevel);
            startTimer();
        }
        
        function startTimer() {
            stopTimer();
            timerInterval = setInterval(() => {
                secondsElapsed++;
                updateTimerDisplay();
            }, 1000);
        }
        
        function stopTimer() {
            clearInterval(timerInterval);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(secondsElapsed / 60);
            const seconds = secondsElapsed % 60;
            document.getElementById('timer-display').textContent = `${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
        }
        
        function updateScoreDisplay() {
            document.getElementById('score-display').textContent = score;
        }
        
        function updateHintsDisplay() {
            document.getElementById('hints-display').textContent = hintsRemaining;
        }
        
        // --- ENVIO DE DADOS PARA PLANILHA ---
        function submitFinalScore() {
            if (!SCRIPT_URL) {
                console.error("URL do Google Apps Script n√£o foi configurada.");
                alert("Erro de configura√ß√£o: A URL para salvar os dados n√£o foi definida.");
                return;
            }
        
            const dataToSend = {
                name: currentPlayer.name,
                cpf: currentPlayer.cpf,
                score: score,
                time: document.getElementById('timer-display').textContent
            };
        
            fetch(SCRIPT_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dataToSend)
            })
            .then(res => res.json())
            .then(result => {
                console.log("Dados enviados com sucesso:", result);
                alert("Pontua√ß√£o enviada! Obrigado por jogar.");
            })
            .catch(error => {
                console.error("Erro ao enviar dados:", error);
                alert("Ocorreu um erro ao salvar sua pontua√ß√£o.");
            });
        }
        
        // --- CHECK ANSWERS ---
        function checkAnswers() {
            const newlyCompletedWords = new Set();
            const allWordKeys = Object.keys(words);
        
            allWordKeys.forEach(wordNum => {
                const { word, direction, start } = words[wordNum];
                const [startRow, startCol] = start;
                let isCorrect = true, isFilled = true;
                const wordCells = [];
        
                for (let i = 0; i < word.length; i++) {
                    const row = direction === 'vertical' ? startRow + 1 + i : startRow;
                    const col = direction === 'horizontal' ? startCol + 1 + i : startCol;
                    const cell = document.getElementById(`cell-${row}-${col}`);
                    const input = cell?.querySelector('input');
                    wordCells.push(cell);
                    if (!input) { isCorrect = false; isFilled = false; break; }
                    if (!input.value) isFilled = false;
                    if (normalize(input.value) !== normalize(word[i])) isCorrect = false;
                }
        
                wordCells.forEach(cell => {
                    if (cell) { cell.classList.remove('correct', 'incorrect'); if (isFilled) cell.classList.add(isCorrect ? 'correct' : 'incorrect'); }
                });
        
                const clue = document.querySelector(`.clue[data-word="${wordNum}"]`);
                if (isFilled && isCorrect) newlyCompletedWords.add(wordNum), clue.classList.add('completed');
                else clue.classList.remove('completed');
            });
        
            completedWords = newlyCompletedWords;
            updateProgress();
        
            if (completedWords.size === Object.keys(words).length) {
                stopTimer();
                document.getElementById('success-message').classList.remove('hidden');
                submitFinalScore();
            }
        }
        
        // --- PROGRESSO ---
        function updateProgress() {
            const totalWords = Object.keys(words).length;
            const percentage = totalWords > 0 ? (completedWords.size / totalWords) * 100 : 0;
            document.getElementById('progress-text').textContent = `${completedWords.size}/${totalWords} palavras`;
            document.getElementById('progress-fill').style.width = percentage + '%';
        }
        
        // --- LIMPAR GRID ---
        function clearGrid() {
            document.querySelectorAll('input[type="text"]').forEach(input => { input.value=''; input.parentElement.classList.remove('correct','incorrect'); });
            document.querySelectorAll('.clue').forEach(clue => clue.classList.remove('completed'));
            completedWords.clear();
            updateProgress();
        }
        </script>
</body>
</html>
