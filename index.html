<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CaÃ§a Palavras SIPAT 2025</title>
<style>
body { font-family: Arial; background: #f0f0f0; display: flex; flex-direction: column; align-items: center; padding: 20px; }
form, .game { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; width: 100%; max-width: 500px; }
input { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc; }
button { padding: 10px 20px; border: none; border-radius: 5px; background: #667eea; color: white; cursor: pointer; }
button:hover { background: #764ba2; }
</style>
</head>
<body>

<h1>ðŸŽ¯ SIPAT 2025</h1>

<form id="playerForm">
    <label for="playerName">Nome Completo *</label>
    <input type="text" id="playerName" required>

    <label for="playerCPF">CPF *</label>
    <input type="text" id="playerCPF" placeholder="000.000.000-00" required>

    <button type="button" onclick="startGame()">Iniciar Jogo</button>
    <div id="errorMessage" style="color:red; margin-top:5px;"></div>
</form>

<div class="game" id="gameScreen" style="display:none;">
    <p>Pontos: <span id="scoreValue">0</span></p>
    <p>Tempo: <span id="timerValue">00:00</span></p>
    <button onclick="finishGame()">Finalizar Jogo</button>
</div>

<script>
let score = 0;
let startTime = null;
let timerInterval = null;

// ValidaÃ§Ã£o simples de CPF
function validateCPF(cpf) {
    cpf = cpf.replace(/[^\d]/g, '');
    return cpf.length === 11;
}

// Formata CPF enquanto digita
document.getElementById('playerCPF').addEventListener('input', function(e){
    let value = e.target.value.replace(/\D/g,'');
    value = value.replace(/(\d{3})(\d)/,'$1.$2');
    value = value.replace(/(\d{3})(\d)/,'$1.$2');
    value = value.replace(/(\d{3})(\d{1,2})$/,'$1-$2');
    e.target.value = value;
});

function startGame() {
    const nome = document.getElementById('playerName').value.trim();
    const cpf = document.getElementById('playerCPF').value;

    const errorDiv = document.getElementById('errorMessage');
    errorDiv.textContent = '';

    if(!nome) { errorDiv.textContent = 'Preencha seu nome'; return; }
    if(!validateCPF(cpf)) { errorDiv.textContent = 'CPF invÃ¡lido'; return; }

    document.getElementById('playerForm').style.display = 'none';
    document.getElementById('gameScreen').style.display = 'block';

    score = 0;
    startTime = Date.now();
    timerInterval = setInterval(updateTimer, 1000);
}

function updateTimer() {
    const elapsed = Date.now() - startTime;
    const minutes = Math.floor(elapsed / 60000);
    const seconds = Math.floor((elapsed % 60000) / 1000);
    document.getElementById('timerValue').textContent = `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
}

function finishGame() {
    clearInterval(timerInterval);

    const nome = document.getElementById('playerName').value;
    const cpf = document.getElementById('playerCPF').value;
    const pontos = score;
    const tempo = document.getElementById('timerValue').textContent;

    // Substitua a URL abaixo pela URL do seu Apps Script
    fetch("https://script.google.com/macros/s/AKfycbzLTJLeMCOQnkQo_cBwNdGfkcn2e22btiQyVKIysTPBHtq3z98dZJmxjFpkPOYTOCHFKA/exec", {
        method: "POST",
        body: JSON.stringify({ nome, cpf, pontos, tempo }),
        headers: { "Content-Type": "application/json" }
    })
    .then(res => res.text())
    .then(data => alert("Jogo finalizado! Dados enviados com sucesso."))
    .catch(err => alert("Erro ao enviar dados: " + err));

    // Opcional: resetar jogo
    document.getElementById('gameScreen').style.display = 'none';
    document.getElementById('playerForm').style.display = 'block';
    document.getElementById('scoreValue').textContent = '0';
    document.getElementById('timerValue').textContent = '00:00';
}
</script>

</body>
</html>
